@page
@model SmartAuditDemo.Pages.Organizations.IndexModel
@{
    ViewData["Title"] = "ูุฏุฑุช ุดุฑฺฉุชโูุง ู ูุดุชุฑุงู";
}

<div class="page-header">
    <h1 class="page-title">ูุฏุฑุช ุดุฑฺฉุชโูุง ู ูุดุชุฑุงู</h1>
    <p class="page-description">ูุฏุฑุช ุงุทูุงุนุงุช ุดุฑฺฉุชโูุง ู ูุดุชุฑุงู</p>
</div>

<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0">ุฌุณุชุฌู ู ููุชุฑ</h5>
    </div>
    <div class="card-body">
        <form method="get" id="filterForm">
            <div class="row g-3">
                <div class="col-md-3">
                    <label class="form-label">ูุงู ุดุฑฺฉุช</label>
                    <input type="text" class="form-control" name="name" value="@Model.Filter.Name" />
                </div>
                <div class="col-md-3">
                    <label class="form-label">ฺฉุฏ ุงูุชุตุงุฏ</label>
                    <input type="text" class="form-control" name="economicCode" value="@Model.Filter.EconomicCode" />
                </div>
                <div class="col-md-2">
                    <label class="form-label">ููุน ุดุฑฺฉุช</label>
                    <select class="form-select" name="companyType">
                        <option value="">ููู</option>
                        <option value="1" selected="@(Model.Filter.CompanyType == CompanyType.PrivateCompany)">ุดุฑฺฉุช ุฎุตูุต</option>
                        <option value="2" selected="@(Model.Filter.CompanyType == CompanyType.PublicCompany)">ุดุฑฺฉุช ุณูุงู ุนุงู</option>
                        <option value="3" selected="@(Model.Filter.CompanyType == CompanyType.LimitedLiability)">ุดุฑฺฉุช ุจุง ูุณุฆููุช ูุญุฏูุฏ</option>
                        <option value="4" selected="@(Model.Filter.CompanyType == CompanyType.Cooperative)">ุดุฑฺฉุช ุชุนุงูู</option>
                        <option value="5" selected="@(Model.Filter.CompanyType == CompanyType.Individual)">ุดุฎุต ุญูู</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="form-label">ูุถุนุช</label>
                    <select class="form-select" name="isActive">
                        <option value="">ููู</option>
                        <option value="true" selected="@(Model.Filter.IsActive == true)">ูุนุงู</option>
                        <option value="false" selected="@(Model.Filter.IsActive == false)">ุบุฑูุนุงู</option>
                    </select>
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <button type="submit" class="btn btn-primary w-100">ุฌุณุชุฌู</button>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">ูุณุช ุดุฑฺฉุชโูุง</h5>
        <a asp-page="./Create" class="btn btn-success btn-sm">
            <i class="me-1">โ</i> ุงุฌุงุฏ ุฌุฏุฏ
        </a>
    </div>
    <div class="card-body">
        @if (Model.Organizations?.Data != null && Model.Organizations.Data.Any())
        {
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th>ูุงู ุดุฑฺฉุช</th>
                            <th>ุดูุงุณู ูู</th>
                            <th>ฺฉุฏ ุงูุชุตุงุฏ</th>
                            <th>ููุน ุดุฑฺฉุช</th>
                            <th>ุฒููู ูุนุงูุช</th>
                            <th>ูุถุนุช</th>
                            <th>ุนููุงุช</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var org in Model.Organizations.Data)
                        {
                            <tr>
                                <td>@org.Name</td>
                                <td>@org.NationalId</td>
                                <td>@org.EconomicCode</td>
                                <td>@org.CompanyTypeName</td>
                                <td>@org.BusinessFieldName</td>
                                <td>
                                    @if (org.IsActive)
                                    {
                                        <span class="badge bg-success">ูุนุงู</span>
                                    }
                                    else
                                    {
                                        <span class="badge bg-danger">ุบุฑูุนุงู</span>
                                    }
                                </td>
                                <td>
                                    <div class="btn-group btn-group-sm" role="group">
                                        <a asp-page="./Details" asp-route-id="@org.Id" class="btn btn-info" title="ุฌุฒุฆุงุช">
                                            <i>๐๏ธ</i>
                                        </a>
                                        <a asp-page="./Edit" asp-route-id="@org.Id" class="btn btn-warning" title="ูุฑุงุด">
                                            <i>โ๏ธ</i>
                                        </a>
                                        <a asp-page="./Delete" asp-route-id="@org.Id" class="btn btn-danger" title="ุญุฐู">
                                            <i>๐๏ธ</i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>

            @if (Model.Organizations.TotalPages > 1)
            {
                <nav aria-label="ุตูุญูโุจูุฏ">
                    <ul class="pagination justify-content-center">
                        @if (Model.Organizations.HasPreviousPage)
                        {
                            <li class="page-item">
                                <a class="page-link" href="?pageNumber=@(Model.Organizations.PageNumber - 1)&name=@Model.Filter.Name&economicCode=@Model.Filter.EconomicCode&companyType=@((int?)Model.Filter.CompanyType)&isActive=@Model.Filter.IsActive">ูุจู</a>
                            </li>
                        }
                        @for (int i = 1; i <= Model.Organizations.TotalPages; i++)
                        {
                            <li class="page-item @(i == Model.Organizations.PageNumber ? "active" : "")">
                                <a class="page-link" href="?pageNumber=@i&name=@Model.Filter.Name&economicCode=@Model.Filter.EconomicCode&companyType=@((int?)Model.Filter.CompanyType)&isActive=@Model.Filter.IsActive">@i</a>
                            </li>
                        }
                        @if (Model.Organizations.HasNextPage)
                        {
                            <li class="page-item">
                                <a class="page-link" href="?pageNumber=@(Model.Organizations.PageNumber + 1)&name=@Model.Filter.Name&economicCode=@Model.Filter.EconomicCode&companyType=@((int?)Model.Filter.CompanyType)&isActive=@Model.Filter.IsActive">ุจุนุฏ</a>
                            </li>
                        }
                    </ul>
                </nav>
            }
        }
        else
        {
            <div class="alert alert-info text-center">
                <p class="mb-0">ูฺ ุณุงุฒูุงู ุงูุช ูุดุฏ.</p>
            </div>
        }
    </div>
</div>

@section Scripts {
    <script>
        // Toast notifications
        @if (TempData["SuccessMessage"] != null)
        {
            <text>
            showToast('@TempData["SuccessMessage"]', 'success');
            </text>
        }
        @if (TempData["ErrorMessage"] != null)
        {
            <text>
            showToast('@TempData["ErrorMessage"]', 'error');
            </text>
        }

        function showToast(message, type) {
            // Simple toast implementation
            const toast = document.createElement('div');
            toast.className = `alert alert-${type === 'success' ? 'success' : 'danger'} position-fixed top-0 start-50 translate-middle-x mt-3`;
            toast.style.zIndex = '9999';
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }
    </script>
}

